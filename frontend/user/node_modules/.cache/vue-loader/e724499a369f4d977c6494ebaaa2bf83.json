{"remainingRequest":"F:\\LeTaoOnlineMall\\frontend\\user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\LeTaoOnlineMall\\frontend\\user\\src\\components\\MyLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\LeTaoOnlineMall\\frontend\\user\\src\\components\\MyLogin.vue","mtime":1657763935386},{"path":"F:\\LeTaoOnlineMall\\frontend\\user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\LeTaoOnlineMall\\frontend\\user\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\LeTaoOnlineMall\\frontend\\user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\LeTaoOnlineMall\\frontend\\user\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIk15TG9naW4iLA0KICBkYXRhKCkgew0KICAgIC8vIOeUqOaIt+WQjeeahOagoemqjOaWueazlQ0KICAgIGxldCB2YWxpZGF0ZU5hbWUgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAoIXZhbHVlKSB7DQogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeeUqOaIt+WQjSIpKTsNCiAgICAgIH0NCiAgICAgIC8vIOeUqOaIt+WQjeS7peWtl+avjeW8gOWktCzplb/luqblnKg1LTE25LmL6Ze0LOWFgeiuuOWtl+avjeaVsOWtl+S4i+WIkue6vw0KICAgICAgY29uc3QgdXNlck5hbWVSdWxlID0gL15bYS16QS1aXVthLXpBLVowLTlfXXs0LDE1fSQvOw0KICAgICAgaWYgKHVzZXJOYW1lUnVsZS50ZXN0KHZhbHVlKSkgew0KICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlRmllbGQoImNoZWNrUGFzcyIpOw0KICAgICAgICByZXR1cm4gY2FsbGJhY2soKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoIuWtl+avjeW8gOWktCzplb/luqY1LTE25LmL6Ze0LOWFgeiuuOWtl+avjeaVsOWtl+S4i+WIkue6vyIpKTsNCiAgICAgIH0NCiAgICB9Ow0KICAgIC8vIOWvhueggeeahOagoemqjOaWueazlQ0KICAgIGxldCB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAodmFsdWUgPT09ICIiKSB7DQogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeWvhueggSIpKTsNCiAgICAgIH0NCiAgICAgIC8vIOWvhueggeS7peWtl+avjeW8gOWktCzplb/luqblnKg2LTE45LmL6Ze0LOWFgeiuuOWtl+avjeaVsOWtl+WSjOS4i+WIkue6vw0KICAgICAgY29uc3QgcGFzc3dvcmRSdWxlID0gL15bYS16QS1aXVx3ezUsMTd9JC87DQogICAgICBpZiAocGFzc3dvcmRSdWxlLnRlc3QodmFsdWUpKSB7DQogICAgICAgIHRoaXMuJHJlZnMucnVsZUZvcm0udmFsaWRhdGVGaWVsZCgiY2hlY2tQYXNzIik7DQogICAgICAgIHJldHVybiBjYWxsYmFjaygpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKA0KICAgICAgICAgIG5ldyBFcnJvcigi5a2X5q+N5byA5aS0LOmVv+W6pjYtMTjkuYvpl7Qs5YWB6K645a2X5q+N5pWw5a2X5ZKM5LiL5YiS57q/IikNCiAgICAgICAgKTsNCiAgICAgIH0NCiAgICB9Ow0KICAgIHJldHVybiB7DQogICAgICBMb2dpblVzZXI6IHsNCiAgICAgICAgbmFtZTogIiIsDQogICAgICAgIHBhc3M6ICIiDQogICAgICB9LA0KICAgICAgLy8g55So5oi35L+h5oGv5qCh6aqM6KeE5YiZLHZhbGlkYXRvcijmoKHpqozmlrnms5UpLHRyaWdnZXIo6Kem5Y+R5pa55byPKSxibHVy5Li65Zyo57uE5Lu2IElucHV0IOWkseWOu+eEpueCueaXtuinpuWPkQ0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgbmFtZTogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZU5hbWUsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgcGFzczogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MsIHRyaWdnZXI6ICJibHVyIiB9XQ0KICAgICAgfQ0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLy8g6I635Y+WdnVleOS4reeahHNob3dMb2dpbu+8jOaOp+WItueZu+W9lee7hOS7tuaYr+WQpuaYvuekug0KICAgIGlzTG9naW46IHsNCiAgICAgIGdldCgpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0U2hvd0xvZ2luOw0KICAgICAgfSwNCiAgICAgIHNldCh2YWwpIHsNCiAgICAgICAgdGhpcy4kcmVmc1sicnVsZUZvcm0iXS5yZXNldEZpZWxkcygpOw0KICAgICAgICB0aGlzLnNldFNob3dMb2dpbih2YWwpOw0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcEFjdGlvbnMoWyJzZXRVc2VyIiwgInNldFNob3dMb2dpbiJdKSwNCiAgICBMb2dpbigpIHsNCiAgICAgIC8vIOmAmui/h2VsZW1lbnToh6rlrprkuYnooajljZXmoKHpqozop4TliJnvvIzmoKHpqoznlKjmiLfovpPlhaXnmoTnlKjmiLfkv6Hmga8NCiAgICAgIHRoaXMuJHJlZnNbInJ1bGVGb3JtIl0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICAvL+WmguaenOmAmui/h+agoemqjOW8gOWni+eZu+W9lQ0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLiRheGlvcw0KICAgICAgICAgICAgLnBvc3QoIi9tYWxsL2NvbnN1bWVyL2xvZ2luIiwgew0KICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy5Mb2dpblVzZXIubmFtZSwNCiAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuTG9naW5Vc2VyLnBhc3MNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAvLyDigJwyMDDigJ3ku6PooajnmbvlvZXmiJDlip/vvIzlhbbku5bnmoTlnYfkuLrlpLHotKUNCiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgICAgIC8vIOmakOiXj+eZu+W9lee7hOS7tg0KICAgICAgICAgICAgICAgIHRoaXMuaXNMb2dpbiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIC8vIOeZu+W9leeUn+aIkOeahOWvhumSpeWtmOWIsOacrOWcsA0KICAgICAgICAgICAgICAgIGxldCB0b2tlbiA9IHJlcy5kYXRhLmRhdGE7DQogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnRva2VuID0gdG9rZW47DQogICAgICAgICAgICAgICAgdGhpcy4kYXhpb3MNCiAgICAgICAgICAgICAgICAgIC5nZXQoIi9tYWxsL2NvbnN1bWVyL2N1cnJlbnRVc2VyIiwgew0KICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdBdXRob3JpemF0aW9uJzogbG9jYWxTdG9yYWdlLnRva2VuIH0NCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICAvLyDigJwyMDDigJ3ku6PooajnmbvlvZXmiJDlip/vvIzlhbbku5bnmoTlnYfkuLrlpLHotKUNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgICAgICAgICAgIC8vIOeZu+W9leS/oeaBr+WtmOWIsOacrOWcsA0KICAgICAgICAgICAgICAgICAgICAgIGxldCB1c2VyID0gSlNPTi5zdHJpbmdpZnkocmVzLmRhdGEuZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInVzZXIiLCB1c2VyKTsNCiAgICAgICAgICAgICAgICAgICAgICAvLyDnmbvlvZXkv6Hmga/lrZjliLB2dWV4DQogICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRVc2VyKHJlcy5kYXRhLmRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgIC8vIOW8ueWHuumAmuefpeahhuaPkOekuueZu+W9leaIkOWKn+S/oeaBrw0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2VlZChyZXMuZGF0YS5tc2cpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIOa4heepuui+k+WFpeahhueahOagoemqjOeKtuaAgQ0KICAgICAgICAgICAgICAgIHRoaXMuJHJlZnNbInJ1bGVGb3JtIl0ucmVzZXRGaWVsZHMoKTsNCiAgICAgICAgICAgICAgICAvLyDlvLnlh7rpgJrnn6XmoYbmj5DnpLrnmbvlvZXlpLHotKXkv6Hmga8NCiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHJlcy5kYXRhLm1zZyk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["MyLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyLogin.vue","sourceRoot":"src/components","sourcesContent":["<!--\r\n * @Description: 登录组件\r\n * @Author: hai-27\r\n * @Date: 2020-02-19 20:55:17\r\n * @LastEditors: hai-27\r\n * @LastEditTime: 2020-03-01 15:34:08\r\n -->\r\n<template>\r\n  <div id=\"myLogin\">\r\n    <el-dialog title=\"登录\" width=\"300px\" center :visible.sync=\"isLogin\">\r\n      <el-form :model=\"LoginUser\" :rules=\"rules\" status-icon ref=\"ruleForm\" class=\"demo-ruleForm\">\r\n        <el-form-item prop=\"name\">\r\n          <el-input prefix-icon=\"el-icon-user-solid\" placeholder=\"请输入账号\" v-model=\"LoginUser.name\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"pass\">\r\n          <el-input prefix-icon=\"el-icon-view\" type=\"password\" placeholder=\"请输入密码\" v-model=\"LoginUser.pass\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button size=\"medium\" type=\"primary\" @click=\"Login\" style=\"width:100%;\">登录</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from \"vuex\";\r\n\r\nexport default {\r\n  name: \"MyLogin\",\r\n  data() {\r\n    // 用户名的校验方法\r\n    let validateName = (rule, value, callback) => {\r\n      if (!value) {\r\n        return callback(new Error(\"请输入用户名\"));\r\n      }\r\n      // 用户名以字母开头,长度在5-16之间,允许字母数字下划线\r\n      const userNameRule = /^[a-zA-Z][a-zA-Z0-9_]{4,15}$/;\r\n      if (userNameRule.test(value)) {\r\n        this.$refs.ruleForm.validateField(\"checkPass\");\r\n        return callback();\r\n      } else {\r\n        return callback(new Error(\"字母开头,长度5-16之间,允许字母数字下划线\"));\r\n      }\r\n    };\r\n    // 密码的校验方法\r\n    let validatePass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        return callback(new Error(\"请输入密码\"));\r\n      }\r\n      // 密码以字母开头,长度在6-18之间,允许字母数字和下划线\r\n      const passwordRule = /^[a-zA-Z]\\w{5,17}$/;\r\n      if (passwordRule.test(value)) {\r\n        this.$refs.ruleForm.validateField(\"checkPass\");\r\n        return callback();\r\n      } else {\r\n        return callback(\r\n          new Error(\"字母开头,长度6-18之间,允许字母数字和下划线\")\r\n        );\r\n      }\r\n    };\r\n    return {\r\n      LoginUser: {\r\n        name: \"\",\r\n        pass: \"\"\r\n      },\r\n      // 用户信息校验规则,validator(校验方法),trigger(触发方式),blur为在组件 Input 失去焦点时触发\r\n      rules: {\r\n        name: [{ validator: validateName, trigger: \"blur\" }],\r\n        pass: [{ validator: validatePass, trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  computed: {\r\n    // 获取vuex中的showLogin，控制登录组件是否显示\r\n    isLogin: {\r\n      get() {\r\n        return this.$store.getters.getShowLogin;\r\n      },\r\n      set(val) {\r\n        this.$refs[\"ruleForm\"].resetFields();\r\n        this.setShowLogin(val);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions([\"setUser\", \"setShowLogin\"]),\r\n    Login() {\r\n      // 通过element自定义表单校验规则，校验用户输入的用户信息\r\n      this.$refs[\"ruleForm\"].validate(valid => {\r\n        //如果通过校验开始登录\r\n        if (valid) {\r\n          this.$axios\r\n            .post(\"/mall/consumer/login\", {\r\n              username: this.LoginUser.name,\r\n              password: this.LoginUser.pass\r\n            })\r\n            .then(res => {\r\n              // “200”代表登录成功，其他的均为失败\r\n              if (res.data.code === 200) {\r\n                // 隐藏登录组件\r\n                this.isLogin = false;\r\n                // 登录生成的密钥存到本地\r\n                let token = res.data.data;\r\n                localStorage.token = token;\r\n                this.$axios\r\n                  .get(\"/mall/consumer/currentUser\", {\r\n                    headers: { 'Authorization': localStorage.token }\r\n                  })\r\n                  .then(res => {\r\n                    // “200”代表登录成功，其他的均为失败\r\n                    if (res.data.code === 200) {\r\n                      // 登录信息存到本地\r\n                      let user = JSON.stringify(res.data.data);\r\n                      localStorage.setItem(\"user\", user);\r\n                      // 登录信息存到vuex\r\n                      this.setUser(res.data.data);\r\n                      // 弹出通知框提示登录成功信息\r\n                      this.notifySucceed(res.data.msg);\r\n                    }\r\n                  })\r\n              } else {\r\n                // 清空输入框的校验状态\r\n                this.$refs[\"ruleForm\"].resetFields();\r\n                // 弹出通知框提示登录失败信息\r\n                this.notifyError(res.data.msg);\r\n              }\r\n            })\r\n            .catch(err => {\r\n              return Promise.reject(err);\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style>\r\n</style>"]}]}